<!--<div class="animated fadeIn">-->
<div class="row">
    <div class="bs-component">
        <div class="panel" id="tab_panel">
            <div class="panel-heading">
                <ul class="nav panel-tabs-border panel-tabs panel-tabs-left">
                    <li class="" style="display: none;"><a href="#reward" data-toggle="tab">奖励明细</a></li>
                    <li class="" style="display: none;"><a href="#manage" data-toggle="tab">礼品卡管理</a></li>
                    <li class="" style="display: none;"><a href="#audit_reward" data-toggle="tab">奖励审核</a></li>
                    <li class="" style="display: none;"><a href="#import" data-toggle="tab">礼品卡导入</a></li>
                    <li class="" style="display: none;"><a href="#withdraw2" data-toggle="tab">礼品卡回收</a></li>
                    <li class="" style="display: none;"><a href="#withdraw" data-toggle="tab">回收记录</a></li>
                </ul>
            </div>
            <div class="panel-body">
                <div class="tab-content pn br-n">
                    <!--tab start-->
                    <div id="reward" class="tab-pane pn" style="display: none;" tabindex="1">
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body">
                                    <div class="form-horizontal admin-form">
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">项目：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                    <select data-id="cnd_projectID" name="cnd-project" class="form-control cnd-project"></select>
                                                    <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">审核状态：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="" class="field prepend-icon">
                                                        <select data-id="cnd_state" class="form-control">
                                                            <option value="">请选择</option>
                                                            <option value="1">审核中</option>
                                                            <option value="2">审核通过</option>
                                                            <option value="3">审核未通过</option>
                                                        </select>
                                                        <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">奖励来源：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                        <select data-id="cnd_origin" class="form-control">
                                                            <option value="">请选择</option>
                                                            <option value="1">答卷</option>
                                                            <option value="2">兑换</option>
                                                        </select>
                                                        <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">礼品卡种类：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                        <select data-id="cnd_giftType" class="form-control">
                                                            <option value="">请选择卡类型</option>
                                                            <option value="1">移动充值卡</option>
                                                            <option value="2">联通充值卡</option>
                                                            <option value="3">电信充值卡</option>
                                                            <option value="4">中石化加油卡</option>
                                                            <option value="5">中石油加油卡</option>
                                                            <option value="6">京东购物卡</option>
                                                        </select>
                                                        <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">起始日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_beginTime" class="form-control weui-datepicker weui-datebegin" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">结束日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_endTime" class="form-control weui-datepicker weui-dateend" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row panel-footer action-container">
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="inputSelect" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <!--<button type="submit" class="btn btn-default btn-block">提交</button>-->
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-0 col-md-0 col-sm-0 control-label"></label>
                                        <div class="col-lg-12 col-md-12 col-sm-12">
                                            <button type="submit" class="btn btn-primary btn-sm pull-right action-query"><i class="fa fa-search"></i>查询</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body pn">
                                    <table class="table table-striped table-hover" id="datatable_reward">
                                        <thead>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                    <!--tab start-->
                    <div id="manage" class="tab-pane pn" style="display: none;" tabindex="2">
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body">
                                    <div class="form-horizontal admin-form">
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">项目：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                    <select data-id="cnd_projectID" class="form-control cnd-project"></select>
                                                    <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">状态：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_state" class="field prepend-icon">
                                                    <select data-id="cnd_state" class="form-control cnd-state">
                                                        <option value="">请选择</option>
                                                        <option value="1">未分配</option>
                                                        <option value="2">已分配</option>
                                                    </select>
                                                    <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">礼品卡种类：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                        <select data-id="cnd_type" class="form-control">
                                                            <option value="">请选择卡类型</option>
                                                            <option value="1">移动充值卡</option>
                                                            <option value="2">联通充值卡</option>
                                                            <option value="3">电信充值卡</option>
                                                            <option value="4">中石化加油卡</option>
                                                            <option value="5">中石油加油卡</option>
                                                            <option value="6">京东购物卡</option>
                                                        </select>
                                                        <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">起始日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_beginTime" class="form-control weui-datepicker weui-datebegin" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">终止日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_endTime" class="form-control weui-datepicker weui-datebegin" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row panel-footer action-container">
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="inputSelect" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <!--<button type="submit" class="btn btn-default btn-block">提交</button>-->
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-0 col-md-0 col-sm-0 control-label"></label>
                                        <div class="col-lg-12 col-md-12 col-sm-12">
                                            <button type="submit" class="btn btn-primary btn-sm pull-right action-query"><i class="fa fa-search"></i>查询</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel">
                                <div class="panel-body pn">
                                    <table class="table table-striped table-hover" id="datatable_manage">
                                        <thead>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                    <!--tab start-->
                    <div id="audit_reward" class="tab-pane pn" style="display: none;" tabindex="3">
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body">
                                    <div class="form-horizontal admin-form">
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">项目：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                    <select data-id="cnd_projectID" name="cnd-project" class="form-control cnd-project"></select>
                                                    <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">起始日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_beginTime" class="form-control weui-datepicker weui-datebegin" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">终止日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_endTime" class="form-control weui-datepicker weui-datebegin" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row panel-footer action-container">
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <!--<button type="submit" class="btn btn-default btn-block">提交</button>-->
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <button type="submit" class="btn btn-primary btn-sm pull-right action-query"><i class="fa fa-search"></i>查询</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel">
                                <div class="panel-body pn">
                                    <table class="table table-striped table-hover" id="datatable_audit_reward">
                                        <thead>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                    <!--tab start-->
                    <div id="import" class="tab-pane pn" style="display: none;" tabindex="4">
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body">
                                    <div class="form-horizontal admin-form">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 col-sm-12">
                                                <form name="messagecontent" id="messagecontent" method="post" enctype="multipart/form-data" action="" class="dropzone">
                                                    <input type="hidden" value="wesurvey" id="impSubSys" name="impSubSys">
                                                    <input type="hidden" value="2" id="impID" name="impID">
                                                    <input type="hidden" id="cacleID" name="cacleID" value="">
                                                </form>
                                            </div>
                                        </div>
                                        <div class="row">
                                        </div>
                                    </div>
                                </div>
                                <div class="row panel-footer action-container admin-form">
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="inputStandard" class="col-lg-2 col-md-2 col-sm-6 control-label p10" style="text-align: right">项目：</label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <label for="cnd_project" class="field prepend-icon">
                                                <select data-id="cnd_projectID" class="form-control cnd-project"></select>
                                                <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <button type="submit" class="btn btn-primary btn-sm pull-right push-btn" disabled><i class="fa fa-upload"></i>上传</button>
                                            <!--<button type="submit" class="btn btn-primary btn-sm pull-right batch-add"><i class="glyphicon glyphicon-file"></i> 上传</button>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel">
                                <div class="panel-body pn">
                                    <table class="table table-striped table-hover" id="datatable_import">
                                        <thead>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                    <!--tab start-->
                    <div id="withdraw2" class="tab-pane pn" style="display: none;" tabindex="5">
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body">
                                    <div class="form-horizontal admin-form">
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">项目：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                    <select data-id="cnd_projectID" name="cnd-project" class="form-control cnd-project"></select>
                                                    <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row panel-footer action-container">
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <!--<button type="submit" class="btn btn-default btn-block">提交</button>-->
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <button type="submit" class="btn btn-primary btn-sm pull-right action-query"><i class="fa fa-search"></i>查询</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel">
                                <div class="panel-body pn">
                                    <table class="table table-striped table-hover" id="datatable_withdraw2">
                                        <thead>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                    <!--tab start-->
                    <div id="withdraw" class="tab-pane pn" style="display: none;" tabindex="6">
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body">
                                    <div class="form-horizontal admin-form">
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label for="inputStandard" class="col-lg-4 col-md-4 col-sm-6 control-label">项目：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label for="cnd_project" class="field prepend-icon">
                                                    <select data-id="cnd_projectID" name="cnd-project" class="form-control cnd-project"></select>
                                                    <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">起始日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_beginTime" class="form-control weui-datepicker weui-datebegin" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                            <label class="col-lg-4 col-md-4 col-sm-6 control-label">结束日期：</label>
                                            <div class="col-lg-8 col-md-8 col-sm-6">
                                                <label class="field prepend-icon">
                                                    <input type="text" data-id="cnd_endTime" class="form-control weui-datepicker weui-dateend" placeholder="">
                                                    <label class="field-icon"><i class="fa fa-calendar-o"></i></label>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row panel-footer action-container">
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="inputSelect" class="col-lg-4 col-md-4 col-sm-6 control-label"></label>
                                        <div class="col-lg-8 col-md-8 col-sm-6">
                                            <!--<button type="submit" class="btn btn-default btn-block">提交</button>-->
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                        <label for="" class="col-lg-0 col-md-0 col-sm-0 control-label"></label>
                                        <div class="col-lg-12 col-md-12 col-sm-12">
                                            <button type="submit" class="btn btn-primary btn-sm pull-right action-query"><i class="fa fa-search"></i>查询</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel panel-visible">
                                <div class="panel-body pn">
                                    <table class="table table-striped table-hover" id="datatable_withdraw">
                                        <thead>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="model_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel"><span class="fa fa-edit"></span><span class="caption"></span></h4>
            </div>
            <div class="form-horizontal admin-form">
                <form id="project_form" method="post" class="weui-form">
                    <div class="modal-body">
                        <div class="row">
                            <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                <label for="col_type" class="col-lg-4 col-md-4 col-sm-6 control-label">类型：</label>
                                <div class="col-lg-8 col-md-8 col-sm-6">
                                    <label class="field prepend-icon">
                                        <select type="select" name="type" class="form-control col_type gui-input" weuifieldcode="parTypeCode" weuifieldname="parType" weuifieldclass="col_parType" required>
                                            <option value="xyz" disabled="disabled">请选择</option>
                                            <option value="1">京东卡</option>
                                            <option value="2">话费卡</option>
                                        </select>
                                        <label class="field-icon"><i class="fa fa-check-square-o"></i></label>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                <label for="col_name" class="col-lg-4 col-md-4 col-sm-6 control-label">面值：</label>
                                <div class="col-lg-8 col-md-8 col-sm-6">
                                    <label class="field prepend-icon">
                                        <input type="text" name="name" class="form-control col_name gui-input" weuifieldname="parValue" weuifieldclass="col_parValue" required>
                                        <label class="field-icon"><i class="fa fa-cubes"></i></label>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <!--<input type="hidden" id="col_subsys" class="gui-input" value="wenjuan">-->
                            <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                <label for="col_name" class="col-lg-4 col-md-4 col-sm-6 control-label">卡号：</label>
                                <div class="col-lg-8 col-md-8 col-sm-6">
                                    <label class="field prepend-icon">
                                        <input type="text" name="name" class="form-control  gui-input" weuifieldname="parID" weuifieldclass="col_parID" required>
                                        <label class="field-icon"><i class="fa fa-cubes"></i></label>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                <label for="col_name" class="col-lg-4 col-md-4 col-sm-6 control-label">卡密：</label>
                                <div class="col-lg-8 col-md-8 col-sm-6">
                                    <label class="field prepend-icon">
                                        <input type="text" name="name" class="form-control col_name gui-input" weuifieldname="parCode" weuifieldclass="col_parCode" required>
                                        <label class="field-icon"><i class="fa fa-cubes"></i></label>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                <label for="col_begindate" class="col-lg-4 col-md-4 col-sm-6 control-label ">发卡日期：</label>
                                <div class="col-lg-8 col-md-8 col-sm-6">
                                    <label class="field prepend-icon">
                                        <input type="text" name="beginDate" class="form-control col_begindate gui-input weui-datepicker weui-datebegin" weuifieldname="issuedAt" weuifieldclass="col_issuedAt" required>
                                        <label class="field-icon"><i class="fa fa-calendar"></i></label>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group col-lg-6 col-md-6 col-sm-12">
                                <label for="col_endDate" class="col-lg-4 col-md-4 col-sm-6 control-label ">失效日期：</label>
                                <div class="col-lg-8 col-md-8 col-sm-6">
                                    <label class="field prepend-icon">
                                        <input type="text" name="endDate" class="form-control col_enddate gui-input weui-datepicker weui-dateend" weuifieldname="expiresAt" weuifieldclass="col_expiresAt" required>
                                        <label class="field-icon"><i class="fa fa-calendar"></i></label>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default btn-sm cancel" data-dismiss="modal"><i class="fa fa-close"></i>关闭</button>
                        <button type="submit" class="btn btn-primary btn-sm accept submit"><i class="fa fa-save"></i><span class="caption"></span></button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var theRewardTable = null,
        theRewardColumns = null,
        theRewardCount = 0,
        theRewardDummy = false,
        theRewardOption = null;
    var theManageTable = null,
        theManageColumns = null,
        theManageCount = 0,
        theManageDummy = false,
        theManageOption = null;
    var theAuditRewardTable = null,
        theAuditRewardColumns = null,
        theAuditRewardCount = 0,
        theAuditRewardDummy = false,
        theAuditRewardOption = null;
    var theImportTable = null,
        theImportColumns = null,
        theImportCount = 0,
        theImportDummy = false,
        theImportOption = null;
    var theWithdraw2Table = null,
        theWithdraw2Columns = null,
        theWithdraw2Count = 0,
        theWithdraw2Dummy = false,
        theWithdraw2Option = null;
    var theWithdrawTable = null,
        theWithdrawColumns = null,
        theWithdrawCount = 0,
        theWithdrawDummy = false,
        theWithdrawOption = null;

    /*
        奖励明细
    */
    $(function() {

        // datatable
        theRewardTable = $('#datatable_reward');
        // columns
        theRewardColumns = [{
            "aTargets": [0],
            "mData": "id",
            "sTitle": "#",
            "sWidth": "12px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return "<input type='checkbox' name='selector' checked='checked' style='margin-left:8px;' />";
            }
        }, {
            "aTargets": [1],
            "mData": "shortName",
            "sTitle": "会员",
            "sWidth": "68px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [2],
            "mData": "projectName",
            "sTitle": "项目",
            "sWidth": "128px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [3],
            "mData": "templateName",
            "sTitle": "问卷",
            "sClass": "text-align-left",
            //"sWidth": "68px",
            "mRender": null
        }, {
            "aTargets": [4],
            "mData": "typeCode",
            "sTitle": "来源",
            "sWidth": "48px",
            "mRender": function(data, type, full) {
                return data == 1 ? "答卷" : "兑换";
            }
        }, {
            "aTargets": [5],
            "mData": "giftCardTypeName",
            "sTitle": "礼品卡",
            "sWidth": "108px",
            "mRender": null
        }, {
            "aTargets": [6],
            "mData": "giftCardAmount",
            "sTitle": "面额",
            "sWidth": "68px",
            "mRender": function(data, type, full) {
                return "￥" + data;
            }
        }, {
            "aTargets": [7],
            "mData": "dateTime",
            "sTitle": "获取时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [8],
            "mData": "auditedAt",
            "sTitle": "审核时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [9],
            "mData": "auditedBy",
            "sTitle": "审核人",
            "sWidth": "68px",
            "mRender": null
        }, {
            "aTargets": [10],
            "mData": "auditRemark",
            "sTitle": "审核意见",
            //"sWidth": "128px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [11],
            "mData": "auditState",
            "sTitle": "审核状态",
            "sWidth": "68px",
            "mRender": function(data, type, full) {
                if (data == 1)
                    return '<span class="fa-stack text-alert"><i class="fa fa-pause fa-stack-1x"></i><i class="fa fa-square-o fa-stack-2x"></i></span><span>审核中</span>';
                else if (data == 2)
                    return '<span class="fa-stack text-success"><i class="fa fa-check fa-stack-1x"></i><i class="fa fa-square-o fa-stack-2x"></i></span><span>审核通过</span>';
                else if (data == 3)
                    return '<span class="fa-stack text-danger"><i class="fa fa-times fa-stack-1x"></i><i class="fa fa-square-o fa-stack-2x"></i></span><span>审核失败</span>';
                else
                    return '';
            }
        }];
        // option
        theRewardOption = {
            aButtons: [{
                "sButtonText": "csv",
                "sExtends": "xls",
            }],
            preDrawCallback: function() {
                return theRewardDummy;
            },
            rowCallback: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                $(nRow).data(aData);
            },
            onCreate: function(data, tr) {},
            onUpdate: function(data, tr) {},
            onDelete: function(data, tr) {},
            processing: true,
            serverSide: true,
            ajaxSource: myapp.apiHost2 + "sysmng.jsonreport.do",
            ajaxDataProp: "objs",
            basicDataCallback: function(aoData) {
                basicData(aoData, 111, theRewardCount, "#reward");
            },
            setCountCallback: function(count) {
                theRewardCount = count;
            }
        };

        //查询
        $("#reward .action-query").unbind("click").bind("click", function() {
            theRewardDummy = true;
            theRewardTable.dataTable().fnDraw();
        });

    });

    /*
        礼品卡管理
    */
    $(function() {

        // datatable
        theManageTable = $('#datatable_manage');
        // columns
        theManageColumns = [{
            "aTargets": [0],
            "mData": "id",
            "sTitle": "#",
            "sWidth": "12px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return "<input type='checkbox' name='selector' checked='checked' style='margin-left:8px;' />";
            }
        }, {
            "aTargets": [1],
            "mData": "projectName",
            "sTitle": "项目",
            //"sWidth": "68px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [2],
            "mData": "typeName",
            "sTitle": "类型",
            "sWidth": "108px",
            "mRender": null
        }, {
            "aTargets": [3],
            "mData": "parValue",
            "sTitle": "面额",
            "sWidth": "48px",
            "mRender": function(data, type, full) {
                return "￥" + data;
            }
        }, {
            "aTargets": [4],
            "mData": "parID",
            "sTitle": "卡号",
            "sWidth": "168px",
            "mRender": null
        }, {
            "aTargets": [5],
            "mData": "parCode",
            "sTitle": "密码",
            "sWidth": "108px",
            "mRender": null
        }, {
            "aTargets": [6],
            "mData": "issuedAt",
            "sTitle": "发卡时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [7],
            "mData": "expiresAt",
            "sTitle": "失效时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [8],
            "mData": "usedAt",
            "sTitle": "使用时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [9],
            "mData": "state",
            "sTitle": "状态",
            "sWidth": "68px",
            "mRender": function(data, type, full) {
                return data == 1 ? "未分配" : (data == 2 ? "已分配" : "已使用");
            }
        }, {
            "aTargets": [10],
            "mData": "active",
            "sTitle": "操作",
            "bSortable": false,
            "sWidth": "38px",
            "mRender": function(data, type, full) {
                return '<span class="inline-action-container">' +
                    '<a href="javascript:;"><span class="fa fa-exclamation-triangle fa-minus-square text-danger"></span><span class="action-delete text-danger">作废</span></a>' +
                    '</span>';
            }
        }];
        // option
        theManageOption = {
            aButtons: [{
                "sButtonText": "csv",
                "sExtends": "xls",
            }],

            preDrawCallback: function() {
                return theManageDummy;
            },
            rowCallback: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                $(nRow).data(aData);
            },
            onCreate: function() {},
            onUpdate: function(data, tr) {},
            onDelete: function(data, tr) {
                var giftData = data;
                new MessageModal($("#message-modal"), "确定要作废选中的条目吗？", tr, function(data) {
                    AjaxPost2(myapp.apiHost2 + "wesurvey.deleteGiftcard.do", giftData, null, function(data) {
                        Core.deleteRow(theManageTable, tr);
                    }, function(error) {
                        alert(error);
                    })
                }).error();
            },
            processing: true,
            serverSide: true,
            ajaxSource: myapp.apiHost2 + "sysmng.jsonreport.do",
            ajaxDataProp: "objs",
            basicDataCallback: function(aoData) {
                basicData(aoData, 35, theManageCount, "#manage");
            },
            setCountCallback: function(count) {
                theManageCount = count;
            }
        };

        //礼品添加理查询
        $("#manage .action-query").unbind("click").bind("click", function() {
            theManageDummy = true;
            theManageTable.dataTable().fnDraw();
        });

    });

    /*
        奖励审核
    */
    $(function() {

        // datatable
        theAuditRewardTable = $('#datatable_audit_reward');
        // columns
        theAuditRewardColumns = [{
            "aTargets": [0],
            "mData": "id",
            "sTitle": "#",
            "sWidth": "12px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return "<input type='checkbox' name='selector' checked='checked' style='margin-left:8px;' />";
            }
        }, {
            "aTargets": [1],
            "mData": "shortName",
            "sTitle": "会员",
            "sWidth": "68px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [2],
            "mData": "projectName",
            "sTitle": "项目",
            "sWidth": "128px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [3],
            "mData": "templateName",
            "sTitle": "问卷",
            //"sWidth": "68px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [4],
            "mData": "typeCode",
            "sTitle": "来源",
            "sWidth": "48px",
            "mRender": function(data, type, full) {
                return data == 1 ? "答卷" : "兑换";
            }
        }, {
            "aTargets": [5],
            "mData": "giftCardTypeName",
            "sTitle": "礼品卡",
            "sWidth": "108px",
            "mRender": null
        }, {
            "aTargets": [6],
            "mData": "giftCardAmount",
            "sTitle": "面额",
            "sWidth": "68px",
            "mRender": function(data, type, full) {
                return "￥" + data;
            }
        }, {
            "aTargets": [7],
            "mData": "dateTime",
            "sTitle": "获取时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [8],
            "mData": "auditedAt",
            "sTitle": "审核时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [9],
            "mData": "auditedBy",
            "sTitle": "审核人",
            "sWidth": "68px",
            "mRender": null
        }, {
            "aTargets": [10],
            "mData": "auditRemark",
            "sTitle": "审核意见",
            //"sWidth": "128px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [11],
            "mData": "id",
            "sTitle": "操作",
            "sWidth": "38px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return '<span class="inline-action-container">' +
                    '<a href="#"><span class="fa fa-check text-success"></span><span class="action-pass text-success">通过</span></a>' +
                    //'<span class="text-divider"> | </span>' +
                    //'<a href="#"><span class="fa fa-minus-circle text-danger"></span><span class="action-decline text-danger">不通过</span></a>' +
                    '</span>';
            }

        }];
        // option
        theAuditRewardOption = {
            aButtons: [{
                "sButtonText": "csv",
                "sExtends": "xls",
            }],
            preDrawCallback: function() {
                return theAuditRewardDummy;
            },
            rowCallback: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                $(nRow).data(aData);
            },
            onCreate: function() {},
            onUpdate: function(data, tr) {},
            onDelete: function(data, tr) {},
            processing: true,
            serverSide: true,
            ajaxSource: myapp.apiHost2 + "sysmng.jsonreport.do",
            ajaxDataProp: "objs",
            basicDataCallback: function(aoData) {
                basicData(aoData, 112, theAuditRewardCount, "#audit_reward");
            },
            setCountCallback: function(count) {
                theAuditRewardCount = count;
            }
        };

        //查询
        $("#audit_reward .action-query").off("click").on("click", function() {
            theAuditRewardDummy = true;
            theAuditRewardTable.dataTable().fnDraw();
        });

        //审核
        $('#datatable_audit_reward').on('click', function(e) {
            var cur = $(e.target);
            if (cur.hasClass('action-pass')) {
                var tr = $(e.target).parents("tr");
                var auditData = tr.data();
                new MessageModal($("#message-modal"), "确定要通过审核？", null, function() {
                    var temp = {
                        op: 'reward',
                        id: auditData.id,
                        giftCardAmount: auditData.giftCardAmount,
                        projectID: auditData.projectID,
                        memberID: auditData.memberID,
                        auditState: 2,
                        giftCardID: auditData.giftCardID
                            //auditRemark: 'this is a test',
                    };
                    AjaxPost2(myapp.apiHost2 + "wesurvey.giftCardAudit.do", temp, null, function(data) {
                        Core.deleteRow(theAuditRewardTable, tr);
                    }, function(error) {
                        alert(error);
                    })
                }).error();
            } else if (cur.hasClass('action-decline')) {
                var tr = $(e.target).parents("tr");
                var auditData = tr.data();
                var modal = new Modal($("#audit-modal"), null, tr, function(data) {
                    var temp = {
                        op: 'reward',
                        id: auditData.id,
                        giftCardAmount: auditData.giftCardAmount,
                        projectID: auditData.projectID,
                        memberID: auditData.memberID,
                        auditState: 3,
                        auditRemark: 'this is a test',
                    };
                    AjaxPost2(myapp.apiHost2 + "wesurvey.emoneyAudit.do", temp, null, function(data) {
                        Core.deleteRow(theAuditConsumeTable, tr);
                    }, function(error) {
                        alert(error);
                    });
                }, {
                    Entity: "项目"
                });
                modal.show();
            }
        });

    });

    /*
        礼品卡导入
    */
    $(function() {

        // datatable
        theImportTable = $('#datatable_import');
        // columns
        theImportColumns = [{
            "aTargets": [0],
            "mData": "parID",
            "sTitle": "#",
            "sWidth": "12px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return "<input type='checkbox' name='selector' checked='checked' style='margin-left:8px;' />";
            }
        }, {
            "aTargets": [1],
            "mData": "typeName",
            "sTitle": "类型",
            //"sWidth": "48px",
            "mRender": null
        }, {
            "aTargets": [2],
            "mData": "parID",
            "sTitle": "卡号",
            "sWidth": "168px",
            "mRender": null
        }, {
            "aTargets": [3],
            "mData": "parValue",
            "sTitle": "面值",
            "sWidth": "48px",
            "mRender": null
        }, {
            "aTargets": [4],
            "mData": "parCode",
            "sTitle": "密码",
            "sWidth": "168px",
            "mRender": null
        }, {
            "aTargets": [5],
            "mData": "issuedAt",
            "sTitle": "发卡日期",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [6],
            "mData": "expiresAt",
            "sTitle": "失效日期",
            "sWidth": "92px",
            "mRender": null
        }];
        // option
        theImportOption = {
            aButtons: [{
                "sButtonText": "csv",
                "sExtends": "xls",
            }],
            preDrawCallback: function() {
                return theImportDummy;
            },
            rowCallback: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                $(nRow).data(aData);
            },
            onCreate: function() {
                var modal = new Modal($("#model_modal"), null, null, function(data) {
                    var url = myapp.apiHost2 + "wesurvey.gifcardadd.do?";
                    AjaxGet2(url, "json", "post", data, function(result) {
                        console.log(data)
                        Core.insertRow(theImportTable, data);
                    }, function(error) {

                    });

                }, {
                    Entity: "项目"
                });
                modal.show();
            },
            onUpdate: function(data, tr) {
                var modal = new Modal($("#model-modal"), data, tr, function(amountdata) {
                    //礼品卡管理
                    var url = myapp.apiHost2 + "wesurvey.gifcardaudit.do?operoState=1";
                    amountdata.value = $(".amount").val();
                    AjaxPost2(url, amountdata, null, function(data) {
                        Core.updateRow(theImportTable, data.objs[0], tr);
                    }, function(error) {
                        alert(error)
                    })
                }, {
                    Entity: "项目"
                });
                modal.show();
            },
            onDelete: function(data, tr) {
                var url = myapp.apiHost2 + "wesurvey.deleteGiftcard.do";
                new MessageModal($("#message-modal"), "确定要废除该礼品卡吗？", null, function(tmpdata) {
                    AjaxPost2(url, data, null, function(data) {
                        Core.deleteRow(theImportTable, tr);
                    }, function(error) {
                        alert(error)
                    })
                }).error();
            },
            processing: true,
            serverSide: true,
            ajaxSource: myapp.apiHost2 + "sysmng.jsonreport.do",
            ajaxDataProp: "objs",
            basicDataCallback: function(aoData) {
                basicData(aoData, 98, theImportCount, "#audit_reward");
            },
            setCountCallback: function(count) {
                theImportCount = count;
            }
        };

        //批量添加触发dropzone
        $(".batch-add").off("click").click(function() {
            AjaxPost2(myapp.apiHost2 + "wesurvey.deltmpmessagingcontact.do", null, null, function(data) {}, function(errot) {});
            $('.push-btn').attr("disabled")
            $('.dropzone').trigger('click');
        })

        //上传
        $('.push-btn').off("click").click(function() {
            var cacleID = $("#cacleID").val();
            var projectID = $("#import .cnd-project").val();
            // projectID == "" ? "999" : projectID;
            AjaxPost2(myapp.apiHost2 + "wesurvey.giftcard.do?cacleID=" + cacleID + "&projectID=" + projectID, null, null, function(data) {}, function(errot) {});
            alert("导入成功，请到礼品卡管理中查看！");
            //删除临时表数据
            AjaxPost2(myapp.apiHost2 + "wesurvey.deltmpmessagingcontact.do", null, null, function(data) {}, function(errot) {});
            //datatable清空数据
            theImportDummy = true;
            theImportTable.dataTable().fnDraw();
            dropzone1.removeAllFiles();
        });
        //dropzone
        var dropzone1;
        $(".dropzone").dropzone({
            url: myapp.apiHost2 + "wesurvey.importmessagecontent.do",
            addRemoveLinks: true,
            dictRemoveLinks: "x",
            dictCancelUpload: "x",
            maxFiles: 1,
            maxFilesize: 1,
            dictDefaultMessage: '<span class="text-center">' +
                '<span class="font-md visible-xs-block visible-sm-block visible-lg-block">' +
                '<span class="font-md"><i class="fa fa-paste text-danger"></i>' +
                '请拖动报告文件 <span class="font-xs">到这里</span>' +
                '</span>' +
                '<span>&nbsp;&nbsp;<h5 class="display-inline">(或点击此处)</h5></span>' +
                '</span>' +
                '</span>',
            dictResponseError: 'Error uploading file!',
            acceptedFiles: ".xls",
            uploadMultiple: false,
            paramName: "impFile",
            init: function() {
                this.on("success", function(file) {
                    theImportDummy = true;
                    theImportTable.dataTable().fnDraw();
                    $('.push-btn').removeAttr("disabled");

                });
                this.on("addedfile", function() {
                    var cacleID = Date.parse(new Date());
                    $('#cacleID').val(cacleID);
                });
                this.on("removedfile", function(file) {
                    AjaxPost2(myapp.apiHost2 + "wesurvey.deltmpmessagingcontact.do", null, null, function(data) {}, function(errot) {});
                    theImportDummy = true;
                    theImportTable.dataTable().fnDraw();
                });
                this.on("complate", function(file) {});
                this.on("error", function(file, error) {
                    //
                });
                dropzone1 = this; //添加引用
            }
        });

    });

    /*
        礼品卡回收
    */
    $(function() {

        // datatable
        theWithdraw2Table = $('#datatable_withdraw2');
        // columns
        theWithdraw2Columns = [{
            "aTargets": [0],
            "mData": "id",
            "sTitle": "#",
            "sWidth": "12px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return "<input type='checkbox' name='selector' checked='checked' style='margin-left:8px;' />";
            }
        }, {
            "aTargets": [1],
            "mData": "name",
            "sTitle": "项目",
            //"sWidth": "128px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [2],
            "mData": "beginDate",
            "sTitle": "起始日期",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [3],
            "mData": "endDate",
            "sTitle": "结束日期",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [4],
            "mData": "director",
            "sTitle": "项目经理",
            "sWidth": "128px",
            "mRender": null
        }, {
            "aTargets": [5],
            "mData": "totalCount",
            "sTitle": "总数量",
            "sWidth": "68px",
            "mRender": null
        }, {
            "aTargets": [6],
            "mData": "totalAmount",
            "sTitle": "总金额",
            "sWidth": "108px",
            "mRender": function(data, type, full) {
                return "￥" + data;
            }
        }, {
            "aTargets": [7],
            "mData": "balanceCount",
            "sTitle": "剩余数量",
            "sWidth": "108px",
            "mRender": null
        }, {
            "aTargets": [8],
            "mData": "balanceAmount",
            "sTitle": "剩余余额",
            "sWidth": "108px",
            "mRender": function(data, type, full) {
                return "￥" + data;
            }
        }, {
            "aTargets": [9],
            "mData": "remark",
            "sTitle": "描述",
            //"sWidth": "128px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [10],
            "mData": "id",
            "sTitle": "操作",
            "bSortable": false,
            "sWidth": "48px",
            "mRender": function(data, type, full) {
                return '<span class="inline-action-container">' +
                    '<a href="#"><span class="fa fa-undo text-danger"></span><span class="action-withdraw text-danger">回收</span></a>' +
                    '</span>';
            }
        }];
        // option
        theWithdraw2Option = {
            aButtons: [{
                "sButtonText": "csv",
                "sExtends": "xls",
            }],
            preDrawCallback: function() {
                return theWithdraw2Dummy;
            },
            rowCallback: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                $(nRow).data(aData);
            },
            onCreate: function() {
                var modal = new Modal($("#model-modal"), null, null, function(data) {});
                modal.show();
            },
            onUpdate: function(data, tr) {
                var modal = new Modal($("#model-modal"), data, tr, function(data) {
                    var url = myapp.apiHost2 + "wesurvey.sumamount.do?operoState=1";
                    var temp = {
                        projectID: data.id,
                        amount: $(".amount").val()
                    };
                    AjaxPost2(url, temp, null, function(data) {
                        Core.updateRow(theWithdraw2Table, data.objs[0], tr);
                    }, function(error) {
                        alert(error);
                    });
                }, {
                    Entity: "项目"
                });
                modal.show();
            },
            onDelete: function(data, tr) {},
            processing: true,
            serverSide: true,
            ajaxSource: myapp.apiHost2 + "sysmng.jsonreport.do",
            ajaxDataProp: "objs",
            basicDataCallback: function(aoData) {
                basicData(aoData, 126, theWithdraw2Count, "#withdraw2");
            },
            setCountCallback: function(count) {
                theWithdraw2Count = count;
            }
        };

        //
        $('#withdraw2 .action-query').unbind('click').bind('click', function() {
            theWithdraw2Dummy = true;
            theWithdraw2Table.dataTable().fnDraw();
        })
        $("#datatable_withdraw2").off('click').on("click", function(e) {
            var tr = $(e.target).parents("tr");
            var cur = $(e.target);
            if (cur.hasClass("action-withdraw")) { //回收
                var rowdata = tr.data();
                var url = myapp.apiHost2 + "wesurvey.withdraw.do?type=3&projectID=" + rowdata.id;
                new MessageModal($("#message-modal"), "确定要回收该项目的礼品卡吗？", null, function(tmpdata) {
                    AjaxPost2(url, null, null, function(data) {
                        Core.initDataTable(theWithdraw2Table, theWithdraw2Columns, theWithdraw2Option);
                        theWithdraw2Dummy = true;
                        theWithdraw2Table.dataTable().fnDraw();
                    }, function(error) {
                        alert(error);
                    });
                }).error();
            }
        });

    });
    /*
        回收记录
    */
    $(function() {

        // datatable
        theWithdrawTable = $('#datatable_withdraw');
        // columns
        theWithdrawColumns = [{
            "aTargets": [0],
            "mData": "id",
            "sTitle": "#",
            "sWidth": "12px",
            "bSortable": false,
            "mRender": function(data, type, full) {
                return "<input type='checkbox' name='selector' checked='checked' style='margin-left:8px;' />";
            }
        }, {
            "aTargets": [1],
            "mData": "projectName",
            "sTitle": "项目",
            //"sWidth": "68px",
            "sClass": "text-align-left",
            "mRender": null
        }, {
            "aTargets": [2],
            "mData": "typeName",
            "sTitle": "类型",
            "sWidth": "108px",
            "mRender": null
        }, {
            "aTargets": [3],
            "mData": "parID",
            "sTitle": "卡号",
            "sWidth": "168px",
            "mRender": null
        }, {
            "aTargets": [4],
            "mData": "parValue",
            "sTitle": "面额",
            "sWidth": "48px",
            "mRender": function(data, type, full) {
                return "￥" + data;
            }
        }, {
            "aTargets": [5],
            "mData": "issuedAt",
            "sTitle": "发卡时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [6],
            "mData": "expiresAt",
            "sTitle": "失效时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [7],
            "mData": "withdrawedAt",
            "sTitle": "使用时间",
            "sWidth": "92px",
            "mRender": null
        }, {
            "aTargets": [8],
            "mData": "withdrawedBy",
            "sTitle": "操作人",
            "sWidth": "92px",
            "mRender": null
        }];
        // option
        theWithdrawOption = {
            aButtons: [{
                "sButtonText": "csv",
                "sExtends": "xls",
            }],
            preDrawCallback: function() {
                return theWithdrawDummy;
            },
            rowCallback: function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                $(nRow).data(aData);
            },
            onCreate: function(data, tr) {},
            onUpdate: function(data, tr) {},
            onDelete: function(data, tr) {},
            processing: true,
            serverSide: true,
            ajaxSource: myapp.apiHost2 + "sysmng.jsonreport.do",
            ajaxDataProp: "objs",
            basicDataCallback: function(aoData) {
                basicData(aoData, 130, theWithdrawCount, "#withdraw");
            },
            setCountCallback: function(count) {
                theWithdrawCount = count;
            }
        };

        //查询
        $("#withdraw .action-query").unbind("click").bind("click", function() {
            theWithdrawDummy = true;
            theWithdrawTable.dataTable().fnDraw();
        });

    });

    /*
     * 
     */
    $(function() {

        //时间控件
        Core.runWeUIElements();

        //
        var activateTabPage = function(index) {
            var tr = '<tr class="odd"><td valign="top" colspan="6" class="dataTables_empty">没有匹配结果</td> </tr>';
            var container = $('.tab-pane[tabindex=' + index + ']');
            if (index == 1) {
                $('table tbody', container).html(tr);
                Core.initDataTable(theRewardTable, theRewardColumns, theRewardOption);
            } else if (index == 2) {
                $('table tbody', container).html(tr);
                Core.initDataTable(theManageTable, theManageColumns, theManageOption);
            } else if (index == 3) {
                $('table tbody', container).html(tr);
                Core.initDataTable(theAuditRewardTable, theAuditRewardColumns, theAuditRewardOption);
            } else if (index == 4) {
                theImportDummy = false;
                AjaxPost2(myapp.apiHost2 + "wesurvey.deltmpmessagingcontact.do", null, null, function(data) {}, function(errot) {});
                $('table tbody', container).html(tr);
                Core.initDataTable(theImportTable, theImportColumns, theImportOption);
            } else if (index == 5) {
                Core.initDataTable(theWithdraw2Table, theWithdraw2Columns, theWithdraw2Option);
                theWithdraw2Dummy = true;
                theWithdraw2Table.dataTable().fnDraw();
            } else if (index == 6) {
                $('table tbody', container).html(tr);
                Core.initDataTable(theWithdrawTable, theWithdrawColumns, theWithdrawOption);
            }
        };

        // trigger
        initTabs(activateTabPage);
        //项目列表
        refreshProjects(".cnd-project", 13);

    });

    //@ sourceURL=dynamicScript-project-giftcard.js
</script>